<!DOCTYPE HTML>
<html lang="zh-CN">


<head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="utf-8">
    <meta name="keywords" content="数据分析-关联规则（购物篮分析）, 城北">
    <meta name="description" content="关联规则算法基础概念1. 关联规则的一般形式项集A、B同时发生的概率称为关联规则的支持度（也称相对支持度）：Support（A→B）= P(A∩B)项集A发生，则项集B发生的概率为关联规则的置信度：Confidence（A→B）= P(B|">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>数据分析-关联规则（购物篮分析） | 城北</title>
    <link rel="icon" type="image/png" href="/medias/logo.png">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">
    <style type="text/css">
        
        code[class*="language-"], pre[class*="language-"] {
            white-space: pre !important;
        }
        
    </style>

    <script src="/libs/jquery/jquery-2.2.0.min.js"></script>
</head>


<body>
<script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>


<header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/favicon.gif" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">城北</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fa fa-navicon"></i></a>
<ul class="right">
    
    <li class="hide-on-med-and-down">
        <a href="/" class="waves-effect waves-light">
            
            <i class="fa fa-home"></i>
            
            <span>首页</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/tags" class="waves-effect waves-light">
            
            <i class="fa fa-tags"></i>
            
            <span>标签</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/categories" class="waves-effect waves-light">
            
            <i class="fa fa-bookmark"></i>
            
            <span>分类</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/archives" class="waves-effect waves-light">
            
            <i class="fa fa-archive"></i>
            
            <span>归档</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/about" class="waves-effect waves-light">
            
            <i class="fa fa-user-circle-o"></i>
            
            <span>关于</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/friends" class="waves-effect waves-light">
            
            <i class="fa fa-address-book"></i>
            
            <span>友情链接</span>
        </a>
    </li>
    
    <li>
        <a href="#searchModal" class="modal-trigger waves-effect waves-light">
            <i id="searchIcon" class="fa fa-search" title="搜索"></i>
        </a>
    </li>
</ul>

<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/favicon.gif" class="logo-img circle responsive-img">
        
        <div class="logo-name">城北</div>
        <div class="logo-desc">
            
            Never really desperate, only the lost of the soul.
            
        </div>
    </div>

    

    <ul class="menu-list mobile-menu-list">
        
        <li>
            <a href="/" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-home"></i>
                
                首页
            </a>
        </li>
        
        <li>
            <a href="/tags" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-tags"></i>
                
                标签
            </a>
        </li>
        
        <li>
            <a href="/categories" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-bookmark"></i>
                
                分类
            </a>
        </li>
        
        <li>
            <a href="/archives" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-archive"></i>
                
                归档
            </a>
        </li>
        
        <li>
            <a href="/about" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-user-circle-o"></i>
                
                关于
            </a>
        </li>
        
        <li>
            <a href="/friends" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-address-book"></i>
                
                友情链接
            </a>
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/CityNorth" class="waves-effect waves-light" target="_blank">
                <i class="fa fa-github-square fa-fw"></i>城北
            </a>
        </li>
        
    </ul>
</div>

        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/CityNorth" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="城北" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>





<div class="bg-cover pd-header post-cover" style="background-image: url('https://raw.githubusercontent.com/CityNorth/material/master/image/guanlianguize.jpg')">
    <div class="container">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <div class="description center-align post-title">
                        数据分析-关联规则（购物篮分析）
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>



<main class="post-container content">

    
    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        margin: 35px 0 15px 0;
        padding-left: 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #toc-content .is-active-link::before {
        background-color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 20px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/R/" target="_blank">
                                <span class="chip bg-color">R</span>
                            </a>
                        
                            <a href="/tags/数据分析/" target="_blank">
                                <span class="chip bg-color">数据分析</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fa fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/数据分析/" class="post-category" target="_blank">
                                数据分析
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                <div class="post-date info-break-policy">
                    <i class="fa fa-calendar-minus-o fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2019-05-22
                </div>

                
                    
                    <div class="info-break-policy">
                        <i class="fa fa-file-word-o fa-fw"></i>文章字数:&nbsp;&nbsp;
                        2.7k
                    </div>
                    

                    
                    <div class="info-break-policy">
                        <i class="fa fa-clock-o fa-fw"></i>阅读时长:&nbsp;&nbsp;
                        11 分
                    </div>
                    
                
				
				
                    <div id="busuanzi_container_page_pv" class="info-break-policy">
                        <i class="fa fa-eye fa-fw"></i>阅读次数:&nbsp;&nbsp;
                        <span id="busuanzi_value_page_pv"></span>
                    </div>
				
            </div>
        </div>
        <hr class="clearfix">
        <div class="card-content article-card-content">
            <div id="articleContent">
                <h2 id="关联规则算法"><a href="#关联规则算法" class="headerlink" title="关联规则算法"></a>关联规则算法</h2><h3 id="基础概念"><a href="#基础概念" class="headerlink" title="基础概念"></a>基础概念</h3><h5 id="1-关联规则的一般形式"><a href="#1-关联规则的一般形式" class="headerlink" title="1. 关联规则的一般形式"></a>1. 关联规则的一般形式</h5><p>项集A、B同时发生的概率称为关联规则的支持度（也称相对支持度）：<br>Support（A→B）= P(A∩B)<br>项集A发生，则项集B发生的概率为关联规则的置信度：<br>Confidence（A→B）= P(B|A）  </p>
<h5 id="2-最小支持度和最小置信度"><a href="#2-最小支持度和最小置信度" class="headerlink" title="2. 最小支持度和最小置信度"></a>2. 最小支持度和最小置信度</h5><p>最小支持度是用户或专家定义的衡量支持度的一个阈值，表示项目集在统计意义上的最低重要性；最小置信度是用户或专家定义的衡量置信度的一个國值，表示关联规则的最低可靠性。同时满足最小支持度國值和最小置信度國值的规则称作强规则。</p>
<h5 id="3-项集"><a href="#3-项集" class="headerlink" title="3. 项集"></a>3. 项集</h5><p>项集是项的集合。包含个项的项集称为左项集，如集合{牛奶，麦片，糖}是一个3项集。<br>项集的出现频率是所有包含项集的事务计数，又称作绝对支持度或支持度计数。如果项集 I 的相对支持度满足预定义的最小支持度阈值，则 I 是频繁项集。  </p>
<h5 id="4-支持度计数"><a href="#4-支持度计数" class="headerlink" title="4. 支持度计数"></a>4. 支持度计数</h5><p>项集A的支持度计数是事务数据集中包含项集」的事务个数，简称为项集的频率或计数。<br>已知项集的支持度计数，则规则A→B的支持度和置信度很容易从所有事务计数、项集A和项集A∩B的支持度计数推出：<br>Support（A→B）= A、B同时发生的事务个数 / 所有事务个数 = Support_count(A∩B) / Total_count(A)Totalcount(A)</p>
<p>Confidence(A→B）= P(A|B) = Support（A∩B) / Support（A) = Support_count(A∩B) / Support_count(A)</p>
<p>也就是说，一旦得到所有事务个数，A，B和A∩B的支持度计数，就可以导出对应的关联规则 A→B 和 B→A，并可以检查该规则是否是强规则。</p>
<ul>
<li>支持度 Support  支持度是指在所有项集中{X, Y}出现的可能性，即项集中同时含有X和Y的概率. </li>
<li>置信度 Confidence   置信度表示在先决条件X发生的条件下，关联结果Y发生的概率(衡量了所考察的关联规则在“质”上的可靠性)</li>
<li><p>提升度 Lift   表示“使用X的用户中同时使用Y的比例”与“使用Y的用户比例”的比值    </p>
<pre><code>  Lift(X-&gt;Y) =Support(X,Y) / Support(X) / Support(Y)  
  ...... =frac{Confidence(X,Y)}{Support(Y)}  
  该指标与置信度同样衡量规则的可靠性，可以看作是置信度的一种互补指标
</code></pre></li>
<li><p>出错率 Conviction  Conviction的意义在于度量规则预测错误的概率,表示X出现而Y不出现的概率  </p>
<pre><code>  Conviction(X-&gt;Y)=(1-Support(Y)) / (1-Confidence(X-&gt;Y))  
</code></pre></li>
</ul>
<h3 id="规则生成基本流程"><a href="#规则生成基本流程" class="headerlink" title="规则生成基本流程"></a>规则生成基本流程</h3><p>一共有2步:</p>
<h5 id="1-找出频繁项集"><a href="#1-找出频繁项集" class="headerlink" title="1. 找出频繁项集"></a>1. 找出频繁项集</h5><p>找出所有的频繁项集（支持度必须大于等于给定的最小支持度阈值），在这个过程中连接步和剪枝步互相融合，最终得到最大频繁项集。  </p>
<ul>
<li>扫描数据项，对每个候选项计数，生成候选1-项集C1</li>
<li>定义最小支持度阈值为2，从C1生成频繁1-项集L1</li>
<li>通过L1xL1生成候选2-项集C2</li>
<li>扫描D，对C2里每个项计数，生成频繁2-项集L2</li>
<li>计算L3xL3，利用apriori性质：频繁项集的子集必然是频繁的，我们可以删去一部分项，从而得到C3，由C3再经过支持度计数生成L3</li>
<li>可见Apriori算法可以分成 <strong>连接，剪枝</strong> 两个步骤不断循环重复</li>
</ul>
<h5 id="2-由频繁项集生成关联规则"><a href="#2-由频繁项集生成关联规则" class="headerlink" title="2. 由频繁项集生成关联规则."></a>2. 由频繁项集生成关联规则.</h5><p>n个item,总共可以产生3^n - 2^(n+1) + 1条规则,指定最小置信度来过滤掉弱规则<br>置信度计算<br>Confidence(A→B）= P(A|B) = Support（A∩B) / Support（A) = Support_count(A∩B) / Support_count(A)</p>
<p>将这些候选规则与最小置信度阙值相比较,不能满足最小置信度的规则将被消除。</p>
<h3 id="R语言实现"><a href="#R语言实现" class="headerlink" title="R语言实现"></a>R语言实现</h3><p>数据读取</p>
<pre><code>setwd(&#39;xx/xx/arules&#39;)
library(arules)
library(data.table)
# --- way1
gou1 &lt;- read.transactions(&quot;./groceries.csv&quot;, format=&quot;basket&quot;, sep=&quot;,&quot;,skip=0)
# as(data.table,&#39;transactions&#39;) 函数转化 
# 参数说明：
# format=c(&quot;basket&quot;, &quot;single&quot;)用于注明源数据的格式。如果源数据每行内容就是一条交易购买的商品列表（类似于一行就是一个购物篮）那么使用basket；如果每行内容是交易号+单个商品，那么使用single。
# cols=c(&quot;transId&quot;, &quot;ItemId&quot;) 对于single格式，需要指定cols，二元向量（数字或字符串）。如果是字符串，那么文件的第一行是表头（即列名）。第一个元素是交易号的字段名，第二个元素是商品编号的字段名。如果是数字，那么无需表头。对于basket，一般设置为NULL，缺省也是NULL，所以不用指定。
# signle format的数据格式如下所示，与此同时，需要设定cols=c(1, 2)
# 1001,Fries
# 1001,Coffee
# 1001,Milk
# 1002,Coffee
# 1002,Fries
# rm.duplicates=FALSE：表示对于同一交易，是否需要删除重复的商品
</code></pre><p>筛选购买两件商品以上的交易  </p>
<pre><code>groceries_use &lt;- groceries[basketSize &gt; 1]  
dim(groceries)
[1] 9835  169  
dim(groceries_use)  
[1] 7676  169
</code></pre><p>每个购物list里包含商品的数量 </p>
<pre><code># 每个购物list里包含商品的数量 length in each basket(row) 
&gt; basketSize&lt;-size(groceries)
&gt; table(basketSize)
basketSize
   1    2    3    4    5    6    7    8    9   10   11   12   13   14   15   16 
2159 1643 1299 1005  855  645  545  438  350  246  182  117   78   77   55   46 
  17   18   19   20   21   22   23   24   26   27   28   29   32 
  29   14   14    9   11    4    6    1    1    1    1    3    1 
# 单个商品的出现频率 Support of each item 
&gt; itemFreq &lt;- itemFrequency(groceries)  
&gt; (head(itemFreq[order(-itemFreq)]))
      whole milk other vegetables       rolls/buns             soda 
       0.2555160        0.1934926        0.1839349        0.1743772 
          yogurt    bottled water 
       0.1395018        0.1105236
</code></pre><p>按最小支持度查看</p>
<pre><code># itemfreq &gt;= 0.1
itemFrequencyPlot(groceries, support= quantile(itemFreq,0.9))  
</code></pre><p>按topn支持度查看</p>
<pre><code># head(itemFreq[order(-itemFreq)],10)
itemFrequencyPlot(groceries, topN=10, horiz=T) 
</code></pre><hr>
<pre><code>library(arules) #加载arules程序包
data(Groceries) #调用数据文件
Inspect(Groceries) #观看数据集里的数据

#求频繁项集
frequentsets=eclat(Groceries,parameter=list(support=0.05,maxlen=10))
inspect(frequentsets[1:10])
inspect(sort(frequentsets,by=&quot;support&quot;)[1:10]) #根据支持度对求得的频繁项集排序并察看

#利用apriori函数提取关联规则
rules&lt;-apriori(Groceries,parameter=list(support=0.01,confidence=0.5))

#规则查看
Inspect(rules)
#Actionable 这些rule提供了非常清晰、有用的洞察，可以直接应用在业务上
</code></pre><h5 id="1-如何发现有用的rule"><a href="#1-如何发现有用的rule" class="headerlink" title="1. 如何发现有用的rule"></a>1. 如何发现有用的rule</h5><ol>
<li><p>按照 lift 对规则进行排序  </p>
<pre><code> ordered_groceryrules &lt;- sort(rules, by=&quot;lift&quot;)
 inspect(ordered_groceryrules[1:5])
</code></pre><p> 其中 lift 是一个类似相关系数的指标。lift=1时表示L和R独立。这个数越大，越表明L和R存在在一个购物篮中不是偶然现象。</p>
</li>
<li><p>规则搜索</p>
<pre><code> yogurtrules &lt;- subset(rules, items %in% c(&quot;yogurt&quot;)) 
 inspect(yogurtrules[1:3])
</code></pre><p> items %in% c(“A”, “B”)表示 lhs+rhs的项集的并集中，至少有一个item是在c(“A”, “B”)  item = A or item = B<br> 如果仅仅想搜索lhs或者rhs，那么用lhs或rhs替换items即可。如：lhs %in% c(“yogurt”)<br> %in%是精确匹配<br> %pin%是部分匹配，也就是说只要item like ‘%A%’ or item like ‘%B%’<br> %ain%是完全匹配，也就是说itemset has ’A’ and itemset has ‘B’  </p>
</li>
<li><p>通过 条件运算符(&amp;, |, !) 添加 support, confidence, lift的过滤条件</p>
<pre><code> fruitrules &lt;- subset(rules, items %pin% c(&quot;fruit&quot;))     
 byrules &lt;- subset(rules, items %ain% c(&quot;berries&quot;))
 fruitrules &lt;- subset(rules, items %pin% c(&quot;fruit&quot;) &amp; lift &gt; 2)
 x=subset(rules,subset=rhs%in%&quot;whole milk&quot;&amp;lift&gt;=1.2) 
</code></pre></li>
<li><p>获取出support,confidence,lift外的其他评价标准</p>
<pre><code> qualityMeasures &lt;- interestMeasure(groceryrules, 
                            measure = c(&quot;coverage&quot;,&quot;fishersExactTest&quot;,
                                     &quot;conviction&quot;, &quot;chiSquared&quot;), 
                            transactions=groceries_use)

 summary(qualityMeasures)
     coverage        fishersExactTest      conviction       chiSquared      
  Min.   :0.009964   Min.   :0.0000000   Min.   :0.9977   Min.   :  0.0106  
  1st Qu.:0.018709   1st Qu.:0.0000000   1st Qu.:1.1914   1st Qu.: 25.0673  
  Median :0.024809   Median :0.0000000   Median :1.2695   Median : 45.6076  
  Mean   :0.032608   Mean   :0.0068474   Mean   :1.3245   Mean   : 54.9651  
  3rd Qu.:0.035892   3rd Qu.:0.0000026   3rd Qu.:1.4091   3rd Qu.: 75.8146  
  Max.   :0.255516   Max.   :0.5881507   Max.   :2.1897   Max.   :350.0989 
</code></pre><ul>
<li>第三个参数transactions：一般情况下都是原来那个数据集，但也有可能是其它数据集，用于检验这些rules在其他数据集上的效果。所以，这也是评估rules的一种方法：在其它数据集上计算这些规则的quality measure用以评估效果。  </li>
<li>fishersExactTest 的p值大部分都是 &gt;= 0.05, 这就说明这些规则反应出了真实的用户的行为模式。</li>
<li>coverage从0.01 ~ 0.30，相当于覆盖到了多少范围的用户。  </li>
<li>ChiSquared: 考察该规则的LHS和RHS是否独立？即LHS与RHS的列联表的ChiSquare Test。p&lt;0.05表示独立，否则表示不独立。  </li>
</ul>
</li>
<li><p>限制挖掘的item  </p>
<p> 可以控制规则的左手边或者右手边出现的item，即appearance。但尽量要放低支持度和置信度  </p>
<pre><code> berriesInLHS &lt;- apriori(groceries, 
                         parameter = list( support = 0.003, 
                                           confidence = 0.1,
                                           minlen=2), 
                         appearance = list(lhs = c(&quot;berries&quot;), 
                                           default=&quot;rhs&quot;))
 # 既然lhs都是&quot;berries&quot;，那么只查看rhs的itemset即可
 &gt; inspect(rhs(berriesInLHS[1:5]))

 # 使用subset进行进一步过滤. 如,不希望看到rhs包含&quot;root vegetables&quot; 或 &quot;whole milk&quot;
 &gt; berrySub &lt;- subset(berriesInLHS, subset = !(rhs %in% c(&quot;root vegetables&quot;, &quot;whole milk&quot;)))
 &gt; inspect(sort(berrySub, by=&quot;confidence&quot;)[1:5])
</code></pre></li>
</ol>
<h5 id="2-其他操作"><a href="#2-其他操作" class="headerlink" title="2. 其他操作"></a>2. 其他操作</h5><ol>
<li><p>保存挖掘的结果</p>
<pre><code> #保存到文件。可以与外部程序进行交换。
 write(rules, file=&quot;./groceryrules.csv&quot;, sep=&quot;,&quot;, quote=TRUE, row.names=FALSE)  
 #转换为data.frame
 &gt; groceryrules_df &lt;- as(rules, &quot;data.frame&quot;)  
 &gt; str(groceryrules_df)  
</code></pre></li>
<li><p>图形展示</p>
<ul>
<li><p>Scatter Plot </p>
<pre><code> library(arulesViz)
 library(RColorBrewer)
 plot(groceryrules,
      control=list(jitter=2,col=rev(brewer.pal(9, &quot;Greens&quot;)[4:9])),
      shading = &#39;lift&#39;)
</code></pre><p> <img src="/2019/05/22/shu-ju-fen-xi/guan-lian-gui-ze/Scatter Plot.png" alt> </p>
<p> shading = “lift”： 表示在散点图上颜色深浅的度量是lift。当然也可以设置为support 或者Confidence<br> jitter=2：增加抖动值<br> col: 调色板，默认是100个颜色的灰色调色板<br> brewer.pal(n, name): 创建调色板：n表示该调色板内总共有多少种颜色；name表示调色板的名字(参考help)<br> 这里使用Green这块调色板，引入9中颜色<br> 这幅散点图表示了规则的分布图：大部分规则的support在0.1以内，Confidence在0-0.8内。每个点的颜色深浅代表了lift的值   </p>
</li>
</ul>
</li>
</ol>
<ul>
<li><p>Grouped Matrix</p>
<pre><code>  plot(groceryrules,method=&#39;grouped&#39;,
   control = list(col=rev(brewer.pal(9, &quot;Greens&quot;)[4:9])))
</code></pre></li>
</ul>
<p><img src="/2019/05/22/shu-ju-fen-xi/guan-lian-gui-ze/Grouped Matrix.png" alt> </p>
<ul>
<li><p>Graph</p>
<pre><code>  top.vegie.rules &lt;- sort(groceryrules,by=c(&#39;support&#39;,&#39;lift&#39;))[1:10]
  plot(top.vegie.rules, measure=&quot;support&quot;, method=&quot;graph&quot;, shading = &quot;lift&quot;)
</code></pre></li>
</ul>
<p><img src="/2019/05/22/shu-ju-fen-xi/guan-lian-gui-ze/Graph.png" alt></p>
<h5 id="5-致谢"><a href="#5-致谢" class="headerlink" title="5. 致谢"></a>5. 致谢</h5><ul>
<li><a href="http://blog.csdn.net/gjwang1983/article/details/45015203" target="_blank" rel="noopener">R语言 | 关联规则</a></li>
<li><a href="https://www.jianshu.com/p/1e9ce1b24626" target="_blank" rel="noopener">购物篮分析-Apriori算法</a></li>
<li><a href="http://www.idatacamp.com/405.html/" target="_blank" rel="noopener">用R语言进行购物篮分析</a></li>
<li><a href="https://yq.aliyun.com/articles/89742" target="_blank" rel="noopener">R语言数据挖掘-2.2购物篮分析</a></li>
<li><a href="https://zhuanlan.zhihu.com/lhf-data/20537735" target="_blank" rel="noopener">购物篮关联分析-R挖掘Apriori算法</a></li>
<li><a href="https://www.douban.com/note/334094701/" target="_blank" rel="noopener">R语言学习之关联规则算法</a></li>
</ul>

            </div>
            <hr/>

            
            <style>
    #reward {
        margin: 40px 0;
        text-align: center;
    }

    #reward .reward-link {
        font-size: 1.88rem;
    }

    #reward .btn-floating:hover {
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2), 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    #rewardModal {
        width: 320px;
        height: 350px;
    }

    #rewardModal .reward-title {
        margin: 15px auto;
        padding-bottom: 5px;
    }

    #rewardModal .modal-content {
        padding: 10px;
    }

    #rewardModal .close {
        position: absolute;
        right: 15px;
        top: 15px;
        color: rgba(0, 0, 0, 0.5);
        font-size: 1.3rem;
        line-height: 20px;
        cursor: pointer;
    }

    #rewardModal .close:hover {
        color: #ef5350;
        transform: scale(1.3);
        -moz-transform:scale(1.3);
        -webkit-transform:scale(1.3);
        -o-transform:scale(1.3);
    }

    #rewardModal .reward-tabs {
        margin: 0 auto;
        width: 210px;
    }

    .reward-tabs .tabs {
        height: 38px;
        margin: 10px auto;
        padding-left: 0;
    }

    .reward-content ul {
        padding-left: 0 !important;
    }

    .reward-tabs .tabs .tab {
        height: 38px;
        line-height: 38px;
    }

    .reward-tabs .tab a {
        color: #fff;
        background-color: #ccc;
    }

    .reward-tabs .tab a:hover {
        background-color: #ccc;
        color: #fff;
    }

    .reward-tabs .wechat-tab .active {
        color: #fff !important;
        background-color: #22AB38 !important;
    }

    .reward-tabs .alipay-tab .active {
        color: #fff !important;
        background-color: #019FE8 !important;
    }

    .reward-tabs .reward-img {
        width: 210px;
        height: 210px;
    }
</style>

<div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-large waves-effect waves-light red">赏</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fa fa-close"></i></a>
            <h4 class="reward-title">您的赏识是我前进的动力</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="/medias/reward/alipay.jpg" class="reward-img" alt="支付宝打赏二维码">
                    </div>
                    <div id="wechat">
                        <img src="/medias/reward/wechat.png" class="reward-img" alt="微信打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>
            

            <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">

<div id="article-share">
    
    <div class="social-share" data-disabled="qzone" data-wechat-qrcode-helper="<p>微信里点“发现”->“扫一扫”二维码便可查看分享。</p>"></div>
    
</div>

<script src="/libs/share/js/social-share.min.js"></script>

            <div class="reprint">
                <p>
                    <span class="reprint-tip">
                        <i class="fa fa-exclamation-circle"></i>&nbsp;&nbsp;转载请注明:
                    </span>
                    <a href="http://CityNorth.github.io" class="b-link-green">城北</a>
                    <i class="fa fa-angle-right fa-lg fa-fw text-color"></i>
                    <a href="/2019/05/22/shu-ju-fen-xi/guan-lian-gui-ze/" class="b-link-green">数据分析-关联规则（购物篮分析）</a>
                </p>
            </div>
        </div>
    </div>

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6 overflow-policy" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fa fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/2019/05/25/luo-ji-si-wei/san-da-fen-xi-fa/">
                    <div class="card-image">
                        
                        <img src="https://raw.githubusercontent.com/CityNorth/material/master/image/sandafenxifa.png" class="responsive-img" alt="三大分析法-SWOT、PEST、波特五力">
                        
                        <span class="card-title">三大分析法-SWOT、PEST、波特五力</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">三大分析法—SWOT、PEST、波特五力
大部分行业中的企业，相互之间的利益都是紧密联系在一起的，作为企业整体战略一部分的各企业竞争战略，其目标都在于使得自己的企业获得相对于竞争对手的优势，所以，在实施中就必然会产生冲突与对抗现象，这些冲突</div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="fa fa-clock-o fa-fw icon-date"></i>2019-05-25
                        </span>
                        <span class="publish-author">
                            
                            <i class="fa fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/逻辑思维/" class="post-category" target="_blank">
                                    逻辑思维
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/逻辑思维/" target="_blank">
                        <span class="chip bg-color">逻辑思维</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6 overflow-policy" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fa fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2019/05/19/shu-ju-fen-xi/r-yu-yan-dian-ying-ping-fen-yu-ce-mo-xing/">
                    <div class="card-image">
                        
                        <img src="https://raw.githubusercontent.com/CityNorth/material/master/image/movie-model.jpg" class="responsive-img" alt="R语言-电影评分预测模型">
                        
                        <span class="card-title">R语言-电影评分预测模型</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">R语言-电影评分预测模型评分系统是一种常见的推荐系统。
现在使用R语言基于协同过滤算法来构建一个电影评分预测模型及电影推荐模型。
一、前提准备
R语言包：  

ggplot2包（绘图），    
recommenderlab包，    
</div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="fa fa-clock-o fa-fw icon-date"></i>2019-05-19
                            </span>
                        <span class="publish-author">
                            
                            <i class="fa fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/R/" class="post-category" target="_blank">
                                    R
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/R/" target="_blank">
                        <span class="chip bg-color">R</span>
                    </a>
                    
                    <a href="/tags/数据分析/" target="_blank">
                        <span class="chip bg-color">数据分析</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>
</div>



    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget">
            <div class="toc-title"><i class="fa fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fa fa-list"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            // headingsOffset: -205,
            headingSelector: 'h2, h3, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h2, h3, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).slideUp(500);
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).slideDown(500);
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>
    

</main>


<footer class="page-footer bg-color">
    <div class="container row center-align">
        <div class="col s12 m8 l8 copy-right">
            &copy; CityNorth&nbsp;&nbsp; 2019 - 2020
            
            
                &nbsp;<i class="fa fa-area-chart"></i>&nbsp;站点总字数:&nbsp;
                <span class="white-color">48.6k</span>
            

            
			
                <br>
                
                <span id="busuanzi_container_site_pv">
                    <i class="fa fa-heart-o"></i>
                    本站总访问量 <span id="busuanzi_value_site_pv" class="white-color"></span>
                </span>
                
                
                <span id="busuanzi_container_site_uv">
                    <i class="fa fa-users"></i>
                    次,&nbsp;访客数 <span id="busuanzi_value_site_uv" class="white-color"></span> 人.
                </span>
                
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/CityNorth" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fa fa-github"></i>
    </a>



    <a href="mailto:1509925520@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fa fa-envelope-open"></i>
    </a>



    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=1509925520" class="tooltipped" data-tooltip="QQ联系我: 1509925520" data-position="top" data-delay="50">
        <i class="fa fa-qq"></i>
    </a>



    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50">
        <i class="fa fa-rss"></i>
    </a>
</div>
    </div>
</footer>

<div class="progress-bar"></div>


<!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fa fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script src="/js/search.js"></script>
<script type="text/javascript">
$(function () {
    searchFunc("/" + "search.xml", 'searchInput', 'searchResult');
});
</script>
<!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fa fa-angle-up"></i>
    </a>
</div>


<script src="/libs/materialize/materialize.min.js"></script>
<script src="/libs/masonry/masonry.pkgd.min.js"></script>
<script src="/libs/aos/aos.js"></script>
<script src="/libs/scrollprogress/scrollProgress.min.js"></script>
<script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
<script src="/js/matery.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->



    <script src="/libs/others/clicklove.js"></script>


    <script async src="/libs/others/busuanzi.pure.mini.js"></script>


 
</body>
</html>